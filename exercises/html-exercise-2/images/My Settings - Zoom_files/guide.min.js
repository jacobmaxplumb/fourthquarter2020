$(function(){Vue.component("imgroupNotice",{template:'            <div class="notice-wrapper1" style="display: block;">            <div class="notice-container notice-low" aria-labelledby="noticeTitle" aria-describedby="noticeContent" tabindex="0" role="contentinfo">            <div class="notice-main-content" id="noticeContent">{{seeWhatChangeText}}<button class="notice-update" @click="showupdate">{{seeWhatChange}}</button><button class="notice-update-mobile" @click="showupdateMobile">{{updateToNewDesigns}}</button></div>            <button class="notice-close1" @click="close" tabindex="0" aria-label="Close Notice"></button>            </div>            </div>        ',name:"imgroupNotice",data:function(){return{seeWhatChangeText:$.i18n.get("group.see_what_changed_text"),seeWhatChange:$.i18n.get("group.see_what_changed"),updateToNewDesigns:$.i18n.get("group.update_to_new_designs")}},methods:{close:function(){a.notice.isShowImgroupNotice=false;SB.post3({url:"/account/closeEnableNewUserGroupUIToast",success:function(){}});b.closeEnableNewUserGroupUItoast=true},showupdate:function(){b.startATour()},showupdateMobile:function(){b.startATourMobile()}}});var a=new Vue({el:"#imgroup-guide-notice-slot",data:function(){return{notice:{isShowImgroupNotice:false}}},methods:{showImgroupNotice:function(){this.notice.isShowImgroupNotice=true;$("#imgroup-guide-notice-slot").find(".notice-wrapper1").css({display:"block"}).slideToggle("1000")}},created:function(){},mounted:function(){if(closeEnableNewUserGroupUItoast||enableNewUserGroupUi){this.notice.isShowImgroupNotice=false}if(!closeEnableNewUserGroupUItoast&&keepOldUserGroupUi&&!enableNewUserGroupUi){this.notice.isShowImgroupNotice=true}}});var c=$.cookie("enable_new_user_group_not_now")||"false";var b=new Vue({el:"#groupNotification",data:function(){return{isImmanage:isImmanage,isAccountSetting:isAccountSetting,isChathistory:isChathistory,isGroupAdmin:isGroupAdmin,enableNewUserGroupUi:enableNewUserGroupUi,canEnableNewUserGroupUi:canEnableNewUserGroupUi,keepOldUserGroupUi:keepOldUserGroupUi,isMergeInProcess:isMergeInProcess,isGroupVisible:false,imgroupNext:c,isDriverVisible:false,driverTitle:"",isShowWaiting:false,mySwiper:null,closeEnableNewUserGroupUItoast:closeEnableNewUserGroupUItoast,confirmUpdateNewDesign:$.i18n.get("group.confirm_update_new_design_desc"),isShowConfirmUpdate:false,waitingTitle:$.i18n.get("group.a_moment_of_new_design"),waitingSubtitle:$.i18n.get("group.waiting_for_change_subtitle1"),swiperIndex:-1,random:0,number:0,isShowSwiper:true,isShowNeedMore:false,needMoreTimeTitle:$.i18n.get("group.need_more_time_for_new_design")}},computed:{driverList:function(){var f=[];if(!this.enableNewUserGroupUi&&this.canEnableNewUserGroupUi){if(this.isGroupAdmin){f.push({title:$.i18n.get("group.dirver_title1"),decription:$.i18n.get("group.dirver_description1"),isPrevious:false,isNext:true})}if(this.isImmanage){var g=f.length>0;f.push({title:$.i18n.get("group.dirver_title2"),decription:$.i18n.get("group.dirver_description2"),isPrevious:g,isNext:true})}if(this.isAccountSetting){var e=f.length>0;f.push({title:$.i18n.get("group.dirver_title3"),decription:$.i18n.get("group.dirver_description3"),isPrevious:e,isNext:true})}if(this.isChathistory){var d=f.length>0;f.push({title:$.i18n.get("group.dirver_title4"),decription:$.i18n.get("group.dirver_description4"),isPrevious:d,isNext:true})}}return f}},methods:{startATour:function(){this.isGroupVisible=false;this.isDriverVisible=true;if(this.isGroupAdmin){$('a[tracking-id="leftNavGroups"]').text($.i18n.get("sidemenu.manage.groupNew"));return this.handleDriver($.i18n.get("group.dirver_title1"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavGroups]")}if(this.isImmanage){var d='<li role="none" class="nav-item" id="contacts-tab">\n<a role="menuitem" tracking-id="leftNavContacts" tracking-category="NavAdmin" href="/account/contacts"/></a>\n</li>';$("ul[aria-labelledby=user-heading-title]").append(d);$('a[tracking-id="leftNavContacts"]').text($.i18n.get("sidemenu.manage.company"));return this.handleDriver($.i18n.get("group.dirver_title2"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavContacts]")}if(this.isAccountSetting){return this.handleDriver($.i18n.get("group.dirver_title3"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavAccountSettings]")}if(this.isChathistory){return this.handleDriver($.i18n.get("group.dirver_title4"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavReports]")}},startATourMobile:function(){this.isGroupVisible=false;this.isShowWaiting=true;$("body .v-modal").css({opacity:"0.6"});this.isShowConfirmUpdate=true;this.updateToNewDesign()},showNextTime:function(){this.isGroupVisible=false;$("body").css({overflow:"auto"});a.notice.isShowImgroupNotice=true;$.cookie("enable_new_user_group_not_now",true,{path:"/",secure:true});this.imgroupNext="true"},goBack:function(d){if(d===$.i18n.get("group.dirver_title2")){return this.handleDriver($.i18n.get("group.dirver_title1"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavGroups]","a[tracking-id=leftNavContacts]")}if(d===$.i18n.get("group.dirver_title3")){if(this.isImmanage){return this.handleDriver($.i18n.get("group.dirver_title2"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavContacts]","a[tracking-id=leftNavAccountSettings]")}else{if(this.isGroupAdmin){return this.handleDriver($.i18n.get("group.dirver_title1"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavGroups]","a[tracking-id=leftNavAccountSettings]")}}}if(d===$.i18n.get("group.dirver_title4")){if(this.isAccountSetting){return this.handleDriver($.i18n.get("group.dirver_title3"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavAccountSettings]","a[tracking-id=leftNavReports]")}else{if(this.isImmanage){return this.handleDriver($.i18n.get("group.dirver_title2"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavContacts]","a[tracking-id=leftNavReports]")}else{if(this.isGroupAdmin){return this.handleDriver($.i18n.get("group.dirver_title1"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavGroups]","a[tracking-id=leftNavReports]")}}}}},goNext:function(e){if(e===$.i18n.get("group.dirver_title1")){if(this.isImmanage){if($("a[tracking-id=leftNavContacts]").length===0){var d='<li role="none" class="nav-item" id="contacts-tab">\n<a role="menuitem" tracking-id="leftNavContacts" tracking-category="NavAdmin" href="/account/contacts"/></a>\n</li>';$("ul[aria-labelledby=user-heading-title]").append(d);$('a[tracking-id="leftNavContacts"]').text($.i18n.get("sidemenu.manage.company"))}return this.handleDriver($.i18n.get("group.dirver_title2"),"ul[aria-labelledby=user-heading-title]","a[tracking-id=leftNavContacts]","a[tracking-id=leftNavGroups]")}if(this.isAccountSetting){return this.handleDriver($.i18n.get("group.dirver_title3"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavAccountSettings]","a[tracking-id=leftNavGroups]")}if(this.isChathistory){return this.handleDriver($.i18n.get("group.dirver_title4"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavReports]","a[tracking-id=leftNavGroups]")}}if(e===$.i18n.get("group.dirver_title2")){if(this.isAccountSetting){return this.handleDriver($.i18n.get("group.dirver_title3"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavAccountSettings]","a[tracking-id=leftNavContacts]")}if(this.isChathistory){return this.handleDriver($.i18n.get("group.dirver_title4"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavReports]","a[tracking-id=leftNavContacts]")}}if(e===$.i18n.get("group.dirver_title3")){if(this.isChathistory){return this.handleDriver($.i18n.get("group.dirver_title4"),"ul[aria-labelledby=account-heading-title]","a[tracking-id=leftNavReports]","a[tracking-id=leftNavAccountSettings]")}}if((e===$.i18n.get("group.dirver_title1")&&!this.isImmanage&&!this.isAccountSetting&&!this.isChathistory)||(e===$.i18n.get("group.dirver_title2")&&!this.isAccountSetting&&!this.isChathistory)||(e===$.i18n.get("group.dirver_title3")&&!this.isChathistory)||e===$.i18n.get("group.dirver_title4")){this.isDriverVisible=false;this.driverTitle="";$('a[tracking-id="leftNavGroups"]').text($.i18n.get("sidemenu.manage.group"));$("body").css({overflow:"auto"});$("a[tracking-id=leftNavGroups]").removeClass("driver-tip");$("a[tracking-id=leftNavContacts]").removeClass("driver-tip");$("a[tracking-id=leftNavAccountSettings]").removeClass("driver-tip");$("a[tracking-id=leftNavReports]").removeClass("driver-tip");this.isShowConfirmUpdate=true}},updateToNewDesign:function(){var d=this;SB.ajax({type:"POST",url:"/account/enableNewUserGroupUI",success:function(e){if(e.status){d.isShowConfirmUpdate=false;d.driverTitle="";d.isShowWaiting=true;d.number=0;setTimeout(function(){d.isShowSwiper=false;d.timer=setInterval(function(){while(d.number<6){d.number++;$.ajax({url:"/account/getEnableNewUserGroupUIStatus",type:"GET",async:false,cache:false,success:function(f){if(f.result){d.isShowWaiting=false;clearInterval(d.timer);$.cookie("get_enable_new_user_group_ui_status","true",{expires:1,path:"/",secure:true});SB.jump("/account/group")}}})}clearInterval(d.timer);d.isShowWaiting=false;d.isShowNeedMore=true},2000)},12500)}else{d.$message({message:e.errorMessage,type:"error",duration:10000});d.isShowConfirmUpdate=false;d.isShowWaiting=false;d.driverTitle="";setTimeout(function(){location.reload(true)},3000)}},error:function(g,h,f){d.$message({message:f.errorMessage,type:"error",duration:10000});d.isShowConfirmUpdate=false;d.driverTitle=""}})},keepExistingDesign:function(){var d=this;d.isShowConfirmUpdate=false;SB.post3({url:"/account/keepOldUserGroupUI",success:function(){d.isGroupVisible=false;$("body").css({overflow:"auto"});a.notice.isShowImgroupNotice=true;if(this.isImmanage&&$("a[tracking-id=leftNavContacts]").length!==0){$('a[tracking-id="leftNavContacts"]').parent().remove()}if($(".side-nav.nav-active-guide").length!==0){$(".side-nav.nav-active-guide").removeClass("nav-active-guide")}}})},handleDriver:function(g,f,e,d){this.driverTitle=g;if(!$(f).parent().hasClass("nav-active")){$(f).parent().addClass("nav-active-guide")}if(d){$(d).removeClass("driver-tip")}$(e).addClass("driver-tip");setTimeout(function(){var i=$(e).offset().top-($(window).height()-$(".pop-box").height());$("html,body").animate({scrollTop:i+"px"},500);$("#groupNotification .pop-box").css({position:"absolute",left:$(e).offset().left+$(e).parent().width()+8,top:(i<0)?($(e).offset().top-$(e).parent().height()-10):($(window).height()-$(".pop-box").height()-50)});return false})},handleOk:function(){this.isShowNeedMore=false;location.reload(true)}},created:function(){},mounted:function(){this.isGroupVisible=!enableNewUserGroupUi&&canEnableNewUserGroupUi&&!keepOldUserGroupUi&&(isGroupAdmin||isImmanage||isAccountSetting||isChathistory)&&(c==="false")&&!closeEnableNewUserGroupUItoast&&!isMergeInProcess;if(!this.enableNewUserGroupUi&&this.canEnableNewUserGroupUi&&!this.keepOldUserGroupUi&&(this.isGroupAdmin||this.isImmanage||this.isAccountSetting||this.isChathistory)&&this.imgroupNext==="false"&&!this.closeEnableNewUserGroupUItoast&&!this.isMergeInProcess){var d=this;d.$nextTick(function(){$("body").css({overflow:"hidden"});d.$refs.title&&d.$refs.title.focus()})}},watch:{isDriverVisible:function(d){if(d){$("#driver-section").removeClass("hideme")}},isShowWaiting:function(e){if(e){var d=this;d.$nextTick(function(){d.mySwiper=new window.Swiper(".swiper-container",{loop:true,observer:true,observeParents:true,effect:"fade",autoplay:{disableOnInteraction:false},pagination:{el:".swiper-pagination"},on:{slideChangeTransitionStart:function(){d.random=Math.random();if($(".swiper-slide1").hasClass("swiper-slide-active")){d.swiperIndex=0;d.waitingSubtitle=$.i18n.get("group.waiting_for_change_subtitle1")}else{if($(".swiper-slide2").hasClass("swiper-slide-active")){d.swiperIndex=1;d.waitingSubtitle=$.i18n.get("group.waiting_for_change_subtitle2")}else{if($(".swiper-slide3").hasClass("swiper-slide-active")){d.swiperIndex=2;d.waitingSubtitle=$.i18n.get("group.waiting_for_change_subtitle3")}}}}}});setTimeout(function(){$("#content_container #content").empty();$("#content_container #footer_container").empty();$("#content_container").addClass("imgroup-empty-content");$("body").css({overflow:"hidden"})})})}},number:function(d){if(d===6){this.timer&&clearInterval(this.timer)}}},beforeDestroy:function(){this.timer&&clearInterval(this.timer)}})});